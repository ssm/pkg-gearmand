#!/usr/bin/make -f

# Figure out the build architecture
DEB_HOST_ARCH ?= $(shell dpkg-architecture -qDEB_HOST_ARCH)

# Only run build tests on some architectures
BUILD_TEST_ARCH_LIST := amd64

# Does not build on 4.7
export CC  := gcc-4.6
export CPP := cpp-4.6
export CXX := g++-4.6

%:
	dh $@ --with autoreconf

ifeq ($(filter $(DEB_HOST_ARCH),$(BUILD_TEST_ARCH_LIST)),)
# Disable automated build tests
override_dh_auto_test:
endif

override_dh_auto_install:
	chrpath -d bin/gearadmin gearmand/gearmand
	dh_auto_install

override_dh_install:
	dh_install --list-missing

override_dh_installchangelogs:
	dh_installchangelogs ChangeLog

override_dh_strip:
	dh_strip --dbg-package=libgearman-dbg

